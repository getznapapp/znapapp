<!DOCTYPE html>
<html>
<head>
    <title>Debug - Znap</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0a0a;
            color: white;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        .success { color: #4ade80; }
        .error { color: #ef4444; }
        .info { color: #94a3b8; }
        .section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 8px;
        }
        .button {
            background: #6366f1;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }
        pre {
            background: #1a1a1a;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Znap Debug Page</h1>
        
        <div class="section">
            <h2 class="success">‚úÖ Static HTML Working</h2>
            <p>This page proves that Netlify is serving static files correctly.</p>
        </div>
        
        <div class="section">
            <h2>üìç Current URL Info</h2>
            <div class="info">
                <strong>Full URL:</strong> <span id="fullUrl"></span><br>
                <strong>Pathname:</strong> <span id="pathname"></span><br>
                <strong>Search:</strong> <span id="search"></span><br>
                <strong>Hash:</strong> <span id="hash"></span><br>
                <strong>Camera ID:</strong> <span id="cameraId"></span>
            </div>
        </div>
        
        <div class="section">
            <h2>üß™ Test Links</h2>
            <a href="/redirect?cameraId=test123" class="button">Test /redirect Route</a>
            <a href="/join/test123" class="button">Test /join Route</a>
            <a href="/" class="button">Test Home Route</a>
            <a href="/debug" class="button">Reload Debug</a>
        </div>
        
        <div class="section">
            <h2>üì± Test Specific Camera Link</h2>
            <div id="testLinks"></div>
        </div>
        
        <div class="section">
            <h2>üîß Browser Info</h2>
            <pre id="browserInfo"></pre>
        </div>
        
        <div class="section">
            <h2>üìù Console Logs</h2>
            <pre id="consoleLogs"></pre>
        </div>
    </div>

    <script>
        // Capture console logs
        const logs = [];
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            logs.push('LOG: ' + args.join(' '));
            originalLog.apply(console, args);
            updateConsoleLogs();
        };
        
        console.error = function(...args) {
            logs.push('ERROR: ' + args.join(' '));
            originalError.apply(console, args);
            updateConsoleLogs();
        };
        
        function updateConsoleLogs() {
            document.getElementById('consoleLogs').textContent = logs.slice(-10).join('\n');
        }
        
        // Display URL info
        document.getElementById('fullUrl').textContent = window.location.href;
        document.getElementById('pathname').textContent = window.location.pathname;
        document.getElementById('search').textContent = window.location.search || '(none)';
        document.getElementById('hash').textContent = window.location.hash || '(none)';
        
        // Extract camera ID
        const urlParams = new URLSearchParams(window.location.search);
        const cameraId = urlParams.get('cameraId');
        document.getElementById('cameraId').textContent = cameraId || '(none)';
        
        // Create test links with actual camera ID if present
        if (cameraId) {
            const testLinksDiv = document.getElementById('testLinks');
            testLinksDiv.innerHTML = `
                <a href="/redirect?cameraId=${cameraId}" class="button">Test Current Camera ID</a>
                <a href="/join/${cameraId}" class="button">Join Current Camera</a>
            `;
        }
        
        // Browser info
        const browserInfo = {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            language: navigator.language,
            cookieEnabled: navigator.cookieEnabled,
            onLine: navigator.onLine,
            screenSize: screen.width + 'x' + screen.height,
            windowSize: window.innerWidth + 'x' + window.innerHeight,
            timestamp: new Date().toISOString()
        };
        
        document.getElementById('browserInfo').textContent = JSON.stringify(browserInfo, null, 2);
        
        // Log debug info
        console.log('=== ZNAP DEBUG PAGE ===');
        console.log('URL:', window.location.href);
        console.log('Camera ID:', cameraId);
        console.log('Browser:', navigator.userAgent);
        
        // Test if React app files exist
        fetch('/index.html')
            .then(response => {
                console.log('index.html status:', response.status);
                return response.text();
            })
            .then(html => {
                console.log('index.html length:', html.length);
                if (html.includes('Loading Znap')) {
                    console.log('‚úÖ React app HTML found');
                } else {
                    console.log('‚ùå React app HTML not found');
                }
            })
            .catch(error => {
                console.error('Failed to fetch index.html:', error);
            });
    </script>
</body>
</html>